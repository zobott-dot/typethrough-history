<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TypeThrough History</title>
    <link href="https://fonts.googleapis.com/css2?family=IM+Fell+English:ital@0;1&family=Special+Elite&family=Crimson+Text:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>

    <header class="header">
        <h1 onclick="goHome()" class="header-link">TypeThrough History</h1>
        <div class="tagline">A Typing Tutor for the Curious Mind</div>
        <div class="sound-controls">
            <button class="sound-btn active" id="soundToggle" onclick="toggleSound()">
                <span id="soundIcon">&#9835;</span>
            </button>
            <span class="sound-label">Typewriter</span>
        </div>
    </header>

    <main class="document">

        <!-- ===== PERSISTENT NAV ===== -->
        <nav class="site-nav" id="siteNav">
            <span class="nav-link" id="navHome" onclick="goHome()">Home</span>
            <span class="nav-separator">&#183;</span>
            <span class="nav-link" id="navJourney" onclick="navigateToJourney()">The Journey</span>
            <span class="nav-separator">&#183;</span>
            <span class="nav-link" id="navStats" onclick="navigateToStats()">My Progress</span>
            <span class="nav-separator">&#183;</span>
            <span class="nav-link" id="navTips" onclick="navigateToTips()">Typing Tips</span>
        </nav>

        <!-- ===== START SCREEN ===== -->
        <div class="start-screen" id="startScreen">
            <div class="ornament">&#10087; &#10022; &#10087;</div>
            <h2 class="start-title">Begin Your Journey</h2>
            <p class="start-subtitle">Through the Early 20th Century</p>
            <p class="start-description">
                Type your way through the defining moments of a turbulent age &mdash;
                from the dawn of flight to the atomic era. Each passage teaches
                as you type.
            </p>

            <div class="mode-toggle">
                <button class="btn btn-mode" id="btnCampaign" onclick="setGameMode('campaign')">Campaign</button>
                <button class="btn btn-mode" id="btnFreeplay" onclick="setGameMode('freeplay')">Free Play</button>
            </div>
            <p class="mode-description" id="modeDescription"></p>

            <div class="typing-mode-toggle">
                <span class="typing-mode-label">Typing mode:</span>
                <button class="btn btn-mode btn-small" id="btnCorrection" onclick="setTypingMode('correction')">Correction</button>
                <button class="btn btn-mode btn-small" id="btnFlow" onclick="setTypingMode('flow')">Flow</button>
                <span class="typing-mode-hint" id="typingModeHint"></span>
            </div>

            <div class="start-era-list" id="eraList">
                <button class="era-btn selected" onclick="selectEra('all')">
                    <span class="era-name">All Eras</span>
                    <span class="era-years">1900&ndash;1945</span>
                    <span class="era-progress" id="eraProgress-all"></span>
                </button>
                <button class="era-btn" onclick="selectEra('The New Century')">
                    <span class="era-name">The New Century</span>
                    <span class="era-years">1900&ndash;1913</span>
                    <span class="era-progress" id="eraProgress-0"></span>
                </button>
                <button class="era-btn" onclick="selectEra('The Great War')">
                    <span class="era-name">The Great War</span>
                    <span class="era-years">1914&ndash;1918</span>
                    <span class="era-progress" id="eraProgress-1"></span>
                </button>
                <button class="era-btn" onclick="selectEra('The Roaring Twenties')">
                    <span class="era-name">The Roaring Twenties</span>
                    <span class="era-years">1919&ndash;1929</span>
                    <span class="era-progress" id="eraProgress-2"></span>
                </button>
                <button class="era-btn" onclick="selectEra('The Great Depression')">
                    <span class="era-name">The Great Depression</span>
                    <span class="era-years">1929&ndash;1939</span>
                    <span class="era-progress" id="eraProgress-3"></span>
                </button>
                <button class="era-btn" onclick="selectEra('The World at War Again')">
                    <span class="era-name">The World at War Again</span>
                    <span class="era-years">1939&ndash;1945</span>
                    <span class="era-progress" id="eraProgress-4"></span>
                </button>
            </div>
            <div class="home-score" id="homeScore" style="display:none;"></div>
            <button class="btn btn-primary" onclick="startTyping()">Begin Typing</button>
            <div class="version">v2.0.0</div>
        </div>

        <!-- ===== STATS DASHBOARD ===== -->
        <div class="stats-screen" id="statsScreen">
            <div class="ornament">&#10087; &#10022; &#10087;</div>
            <h2 class="start-title">Your Progress</h2>
            <div class="results-ornament">&mdash; &#10022; &mdash;</div>

            <div class="results-stats" style="margin-bottom: 1.5rem;">
                <div class="result-stat">
                    <span class="result-stat-value" id="statsTotalScore">0</span>
                    <span class="result-stat-label">Total Score</span>
                </div>
                <div class="result-stat">
                    <span class="result-stat-value" id="statsTotalPassages">0</span>
                    <span class="result-stat-label">Earned</span>
                </div>
                <div class="result-stat">
                    <span class="result-stat-value" id="statsBestWpm">0</span>
                    <span class="result-stat-label">Best WPM</span>
                </div>
                <div class="result-stat">
                    <span class="result-stat-value" id="statsAvgWpm">0</span>
                    <span class="result-stat-label">Avg WPM</span>
                </div>
                <div class="result-stat">
                    <span class="result-stat-value" id="statsAvgAccuracy">0%</span>
                    <span class="result-stat-label">Avg Accuracy</span>
                </div>
            </div>

            <div class="stats-era-section">
                <h3 class="stats-chart-title">Era Progress</h3>
                <div id="statsEraProgress"></div>
            </div>

            <div class="stats-trouble-section">
                <h3 class="stats-chart-title">Trouble Spots</h3>
                <div id="statsTroubleSpots">
                    <div class="stats-chart-empty">Type a few passages to reveal your trouble spots.</div>
                </div>
            </div>

            <div class="stats-chart-section">
                <h3 class="stats-chart-title">Last 20 Sessions</h3>
                <div class="stats-chart" id="statsChart">
                    <div class="stats-chart-empty">Complete a few passages to see your trend here.</div>
                </div>
            </div>

            <div class="stats-recent-section">
                <h3 class="stats-chart-title">Recent Passages</h3>
                <div class="stats-recent-list" id="statsRecentList">
                    <div class="stats-chart-empty">No passages completed yet.</div>
                </div>
            </div>

            <div class="button-row" style="margin-top: 1.5rem;">
                <button class="btn" onclick="clearStats()">Clear History</button>
            </div>
        </div>

        <!-- ===== THE JOURNEY ===== -->
        <div class="journey-screen" id="journeyScreen">
            <div class="ornament">&#10087; &#10022; &#10087;</div>
            <h2 class="start-title">The Journey</h2>
            <p class="journey-subtitle">1900 &mdash; 1945</p>

            <div class="journey-score" id="journeyScore"></div>

            <div class="journey-timeline" id="journeyTimeline">
                <!-- Rendered by JS -->
            </div>

            <div class="journey-milestones" id="journeyMilestones">
                <!-- Rendered by JS -->
            </div>
        </div>

        <!-- ===== TYPING TIPS ===== -->
        <div class="tips-screen" id="tipsScreen">
            <div class="ornament">&#10087; &#10022; &#10087;</div>
            <h2 class="start-title">Typing Tips</h2>
            <div class="results-ornament">&mdash; &#10022; &mdash;</div>

            <div class="tips-content">
                <div class="tips-section">
                    <h3 class="tips-heading">Home Row Position</h3>
                    <p class="tips-text">Rest your fingers on the home row &mdash; the foundation of touch typing. Your fingers should return here after every reach.</p>
                    <div class="keyboard-diagram">
                        <div class="kb-row">
                            <span class="kb-key">Q</span><span class="kb-key">W</span><span class="kb-key">E</span><span class="kb-key">R</span><span class="kb-key">T</span><span class="kb-key">Y</span><span class="kb-key">U</span><span class="kb-key">I</span><span class="kb-key">O</span><span class="kb-key">P</span>
                        </div>
                        <div class="kb-row">
                            <span class="kb-key kb-home kb-left-pinky">A</span><span class="kb-key kb-home kb-left-ring">S</span><span class="kb-key kb-home kb-left-middle">D</span><span class="kb-key kb-home kb-left-index">F</span><span class="kb-key">G</span><span class="kb-key">H</span><span class="kb-key kb-home kb-right-index">J</span><span class="kb-key kb-home kb-right-middle">K</span><span class="kb-key kb-home kb-right-ring">L</span><span class="kb-key kb-home kb-right-pinky">;</span>
                        </div>
                        <div class="kb-row">
                            <span class="kb-key">Z</span><span class="kb-key">X</span><span class="kb-key">C</span><span class="kb-key">V</span><span class="kb-key">B</span><span class="kb-key">N</span><span class="kb-key">M</span><span class="kb-key">,</span><span class="kb-key">.</span><span class="kb-key">/</span>
                        </div>
                        <div class="kb-row">
                            <span class="kb-key kb-space">Space &mdash; either thumb</span>
                        </div>
                        <div class="kb-legend">
                            <span class="kb-legend-item"><span class="kb-swatch kb-left-pinky"></span> Pinky</span>
                            <span class="kb-legend-item"><span class="kb-swatch kb-left-ring"></span> Ring</span>
                            <span class="kb-legend-item"><span class="kb-swatch kb-left-middle"></span> Middle</span>
                            <span class="kb-legend-item"><span class="kb-swatch kb-left-index"></span> Index</span>
                        </div>
                    </div>
                </div>

                <div class="tips-section">
                    <h3 class="tips-heading">The Bumps on F and J</h3>
                    <p class="tips-text">Feel for the small raised bumps on the F and J keys. These are your anchors &mdash; your index fingers live here. Every other finger finds its place relative to these two keys.</p>
                </div>

                <div class="tips-section">
                    <h3 class="tips-heading">Don't Look Down</h3>
                    <p class="tips-text">The hardest habit to build and the most important. Keep your eyes on the screen. You will make mistakes at first &mdash; that's the point. Your fingers learn by repetition, not by sight.</p>
                </div>

                <div class="tips-section">
                    <h3 class="tips-heading">Correction Mode vs Flow Mode</h3>
                    <p class="tips-text"><strong>Correction mode</strong> lets you backspace and fix errors, which builds careful habits. <strong>Flow mode</strong> disables backspace &mdash; you move forward through mistakes, which builds speed and muscle memory. Try both and see which suits your practice.</p>
                </div>

                <div class="tips-section">
                    <h3 class="tips-heading">Accuracy First, Speed Later</h3>
                    <p class="tips-text">Type at whatever speed lets you stay above 85% accuracy. Speed follows accuracy naturally. If you're making lots of errors, slow down &mdash; you're training your fingers to hit the wrong keys.</p>
                </div>
            </div>
        </div>

        <!-- ===== TYPING SCREEN ===== -->
        <div class="typing-screen" id="typingScreen">

            <div class="passage-info">
                <span class="passage-era" id="passageEra"></span>
                <span class="passage-difficulty" id="passageDifficulty"></span>
                <span class="passage-count" id="passageCount"></span>
                <span class="typing-mode-indicator" id="typingModeIndicator"></span>
            </div>

            <h3 class="passage-title" id="passageTitle"></h3>

            <div class="passage-display" id="passageDisplay"></div>

            <div class="click-prompt" id="clickPrompt" onclick="activateTyping()">
                Click here or press any key to begin typing...
            </div>

            <input type="text" class="typing-input" id="typingInput"
                   autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">

            <div class="progress-bar-container">
                <div class="progress-bar-fill" id="progressBar"></div>
            </div>

            <div class="live-stats" id="liveStats">
                <div class="stat">
                    <span class="stat-value" id="liveWpm">0</span>
                    <span class="stat-label">WPM</span>
                </div>
                <div class="stat">
                    <span class="stat-value" id="liveAccuracy">100%</span>
                    <span class="stat-label">Accuracy</span>
                </div>
                <div class="stat">
                    <span class="stat-value" id="liveProgress">0%</span>
                    <span class="stat-label">Progress</span>
                </div>
                <div class="stat stat-quit">
                    <button class="btn-quit" onclick="skipPassage()">Skip &rarr;</button>
                </div>
            </div>

            <!-- Results (shown after completing a passage) -->
            <div class="results" id="results">
                <h3 class="results-title">Passage Complete</h3>
                <div class="results-ornament">&mdash; &#10022; &mdash;</div>
                <div class="results-rating" id="resultsRating"></div>
                <div class="result-score" id="finalScore"></div>
                <div class="passage-earned-msg" id="passageEarnedMsg"></div>
                <div class="results-stats">
                    <div class="result-stat">
                        <span class="result-stat-value" id="finalWpm">0</span>
                        <span class="result-stat-label">Words per Minute</span>
                    </div>
                    <div class="result-stat">
                        <span class="result-stat-value" id="finalAccuracy">0%</span>
                        <span class="result-stat-label">Accuracy</span>
                    </div>
                    <div class="result-stat">
                        <span class="result-stat-value" id="finalErrors">0</span>
                        <span class="result-stat-label">Errors</span>
                    </div>
                </div>
                <div class="footnote" id="footnote">
                    <span class="footnote-label">Historical Footnote</span>
                    <span id="footnoteText"></span>
                </div>
                <div class="button-row">
                    <button class="btn" onclick="retryPassage()">Try Again</button>
                    <button class="btn btn-primary" id="nextBtn" onclick="nextPassage()">Next Passage</button>
                </div>
            </div>

        </div>
    </main>

    <!-- Scripts loaded in order: data first, then engine, then app logic -->
    <script src="js/passages.js"></script>
    <script src="js/sounds.js"></script>
    <script src="js/app.js"></script>

</body>
</html>
